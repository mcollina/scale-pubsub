<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Building a Scalable Pub/Sub System with UpRing</title>
    <link rel="stylesheet" type="text/css" href="build/build.css">
  </head>
  <body>
    <article>
      <section data-bespoke-backdrop="black" class="trans">
        <div style="text-align: left; margin-top: -2em; color: white">
          <h1>Building a Scalable Pub/Sub System with UpRing</h1>
          <div style="width: 50%; float: right; margin-bottom: -50em;"><a href="http://nearform.com"><img src="./images/nearform.svg"></a></div>
          <h3 style="color: white">by&nbsp;<a style="display:inline-block;margin-left: -.03em; color: white" href="http://twitter.com/matteocollina">@matteocollina</a></h3>
        </div>
      </section>
      <section><img src="images/upring.svg" style="width: 90%"></section>
      <section>
        <h2>DEMO KV</h2><a href="https://github.com/upringjs/upring-demos">https://github.com/upringjs/upring-demos</a>
      </section>
      <section data-bespoke-backdrop="baloons" class="trans">
        <h2 style="color:white">How can we support<br>live-updates to our users?</h2>
      </section>
      <section data-bespoke-backdrop="foxes" class="trans"></section>
      <section data-bespoke-backdrop="foxes" class="transgray">
        <h2 style="color: white">How can we know which node handle what connection?</h2>
      </section>
      <section>
        <h2>Divide et Impera</h2>
        <h3>(Philip of Macedonia)</h3>
      </section>
      <section>
        <h3>Application-Level Sharding</h3><img src="./images/reqhashing.png" style="width: 90%">
        <!-- Given a request referencing data X, we must always route it to peer Y.-->
      </section>
      <section>
        <h3>How do we assign data to servers?</h3><img src="images/sharding.png" style="height: 80%">
      </section>
      <section>
        <h3>What happens when you read on UpRing?</h3><img src="./images/read.png" style="height: 90%">
      </section>
      <section>
        <h3>What happens when you write on UpRing?</h3><img src="./images/write.png" style="height: 90%">
      </section>
      <section><img src="images/dynamodb.png" style="width: 90%"></section>
      <section><img src="./images/dynamo-strategy-one.png" style="height: 90%"></section>
      <section>
        <h2>What happens<br>when a peer dies?</h2>
      </section>
      <section><img src="./images/read.png" style="height: 90%"></section>
      <section>
        <h3>What happens when a peer dies?</h3><img src="./images/peer-dead.png" style="height: 90%">
      </section>
      <section>
        <h2>Failure detection</h2><img src="./images/heartbeat.png" style="width: 90%">
        <h2>by heartbeat</h2>
      </section>
      <section data-bespoke-backdrop="books" class="trans"></section>
      <section>
        <ul style="text-align: left; font-size: 3em" class="bullet">
          <li><b style="color: red; font-style: italic;">S</b>calable</li>
          <li><b style="color: red; font-style: italic;">W</b>eakly-Consistent</li>
          <li><b style="color: red; font-style: italic;">I</b>nfection Style</li>
          <li><b style="color: red; font-style: italic;">M</b>embership protocol</li>
        </ul>
      </section>
      <section><img src="images/swim.png" style="width: 90%"></section>
      <section data-bespoke-backdrop="lamp" class="trans">
        <h3 style="color: white; margin-left: auto; margin-right: 0%; width: 30%; text-align: right; padding-bottom: 5%">
          UpRing organizes our peers in a <b>consistent hashring</b>,
          using <b>SWIM</b> to detect failures
        </h3>
      </section>
      <section data-bespoke-backdrop="magic" class="trans"></section>
      <section><img src="images/hashring-sharding.png" style="height: 90%"></section>
      <section>
        <h2>Differences between UpRing and Raft/Paxos</h2>
        <ul style="text-align: left" class="bullet">
          <li>
            in UpRing, a leader is staticially decided based on the key
            so there are multiple leaders
          </li>
          <li>
            in Raft and Paxos, there is a single leader, elected by all the
            peers
          </li>
        </ul>
      </section>
      <section>
        <h2>Differences between UpRing and Raft/Paxos</h2>
        <ul style="text-align: left" class="bullet">
          <li>
            in UpRing, the stability of the cluster depends on the gossip
            convergence, every peer must know who else is available to hash
            the key
          </li>
          <li>
            in Raft and Paxos, you need at least 3 nodes to operate,
            but better use 5
          </li>
        </ul>
      </section>
      <section data-bespoke-backdrop="megaphone" class="transgray">
        <h2 style="color: white; margin-top: -3em;">so... how can we build a pub/sub system with UpRing?</h2>
      </section>
      <section><img src="images/just-publish.png" style="height: 90%"></section>
      <section><img src="images/pub-sub.png" style="height: 90%"></section>
      <section><img src="images/pub-sub-state-change.png" style="height: 90%"></section>
      <section><img src="images/sub-wildcard.png" style="height: 90%"></section>
      <section>
        <h2>DEMO publish-subscribe</h2><a href="https://github.com/upringjs/upring-demos">https://github.com/upringjs/upring-demos</a>
      </section>
      <section>
        <h3>Upring is a framework to&nbsp;<b>build</b></h3>
        <ul class="bullet">
          <li>a key value store</li>
          <li>a cache</li>
          <li>a pub/sub system</li>
          <li>a real-time application</li>
          <li>a discovery system</li>
          <li>a metadata store for microservices</li>
          <li>..or anything that requires distributed state!</li>
        </ul>
      </section>
      <section>
        <h2>Links</h2>
        <ul class="bullet">
          <li><a href="https://github.com/upringjs/upring">https://github.com/upringjs/upring</a></li>
          <li><a href="https://github.com/upringjs/upring-kv">https://github.com/upringjs/upring-kv</a></li>
          <li><a href="https://github.com/upringjs/upring-control">https://github.com/upringjs/upring-control</a></li>
          <li><a href="https://github.com/upringjs/upring-pubsub">
              https://github.com/upringjs/upring-pubsub
              </a></li>
        </ul>
      </section>
      <section>
        <h2>This presentation</h2>
        <ul class="bullet">
          <li><a href="https://upringjs.github.io/scale-pubsub">https://upringjs.github.io/scale-pubsub</a></li>
          <li><a href="https://github.com/mcollina/scale-pubsub">
              https://github.com/upringjs/scale-pubsub
              </a></li>
        </ul>
      </section>
      <!-- section-->
      <!--   a(href="http://nearform.com" style="width: 80%")-->
      <!--     img(src="./images/nearform.svg")-->
      <!--   br-->
      <!--   h2 We are hiring React developers!-->
      <!--   br-->
      <!--   h3 <a href="mailto:matteo.collina@nearform.com">matteo.collina@nearform.com</a>-->
      <section>
        <h1>Thanks!</h1><a href="http://nearform.com" style="width: 20%"><img src="./images/nearform.svg"></a><br>
        <h3><a href="mailto:matteo.collina@nearform.com">matteo.collina@nearform.com</a></h3>
        <h3><a href="http://twitter.com/matteocollina">@matteocollina</a></h3>
        <h3><a href="mailto:luca.maraschi@nearform.com">luca.maraschi@nearform.com</a></h3>
        <h3><a href="http://twitter.com/lucamaraschi">@lucamaraschi</a></h3>
        <h3><a href="http://www.nearform.com">www.nearform.com</a></h3>
      </section>
    </article>
    <script src="build/build.js"></script>
  </body>
</html>